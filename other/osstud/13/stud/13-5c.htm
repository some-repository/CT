<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>5c-s13-14s</title>
</head>

<body>
 <basefont face="Times New Roman, sans-serif, Courier, mono" size="3">
<p><font  face="Times New Roman, sans-serif, Courier, mono" size="3"  color="#008000"><font color="#000000">/* 
  Программа с пользовательской обработкой сигнала <b><font color="#008000">SIGINT</font></b>, 
  возвращаюшаяся к первоначальной реакции на этот сигнал после 5 его обработок*/</font><b><br>
  <br>
  #include &lt;signal.h&gt;<br>
  #include &lt;stdio.h&gt;<br>
  <br>
  int i=0; </b><font color="#000000">/* Счетчик числа обработок сигнала */</font><b><br>
  void (*p)(int);</b><font color="#000000"> /* Указатель, в который будет занесен 
  адрес предыдущего обработчика сигнала */ </font><b><br>
  <br>
  </b> <font color="#000000">/* Функция</font><b> my_handler </b><font color="#000000">- 
  пользовательский обработчик сигнала */</font><b> <br>
  <br>
  void my_handler(int nsig){</b></font> 
<dir> <font face="Times New Roman, sans-serif, Courier, mono" size="3" color="#008000"> 
  <b> printf("Receive signal %d, CTRL-C pressed\n"); i = i+1;<br>
  <br>
  </b> <font color="#000000">/* После 5-й обработки возвращаем первоначальную 
  реакцию на сигнал */</font><b><br>
  <br>
  if(i == 5) (void)signal(SIGINT, p);</b></font></dir>
  <font face="Times New Roman, sans-serif, Courier, mono" size="3" color="#008000"> <b>
  }<br>
  <br>
  int main(void){ </b></font> <br>
<dir> <font face="Times New Roman, sans-serif, Courier, mono" size="3" color="#000000"> 
  /* Выставляем свою реакцию процесса на сигнал</font><font  face="Times New Roman, sans-serif, Courier, mono" size="3"  color="#008000"><b> 
  SIGINT</b>, <font color="#000000">запоминая адрес предыдущего обработчика */ 
  </font><b><br>
  <br>
  p = <a href="../../man/signal.htm">signal</a>(SIGINT, my_handler);<br>
  <br>
  </b> <font color="#000000">/*Начиная с этого места, процесс будет 5 раз печатать 
  сообщение о возникновении сигнала</font><b> SIGINT </b><font color="#000000">*/</font><b> 
  <br>
  <br>
  while(1);<br>
  return 0;<br>
  </b></font> </dir>
   <font  face="Times New Roman, sans-serif, Courier, mono" size="3"  color="#008000"><b>
}
</b></font> 

</body>

</html>
