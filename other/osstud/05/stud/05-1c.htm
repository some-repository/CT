<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>1.c-s4s</title>
</head>

<body>

<p><font size="3" color="#008000"><b><font color="#000000">/* Программа, иллюстрирующая 
  использование системных вызовов </font>open(), write() <font color="#000000">и</font> 
  close() <font color="#000000">для записи информации в файл*/</font></b></font> 
<p><font size="3" color="#008000"><b><br>
  #include &lt;sys/types.h&gt;<br>
  #include &lt;fcntl.h&gt;<br>
  #include &lt;stdio.h&gt;<br>
  <br>
int main(){<br>
</b><dir><b> int fd; <br>
  size_t size;<br>
  char string[] = &quot;Hello, world!&quot;;<br>
  <br>
  <font color="#000000">/* Обнуляем</font> <a href="../../man/umask3.htm">маску 
  создания файлов текущего процесса</a> <font color="#000000">для того, чтобы<br>
  права доступа у создаваемого файла точно соотвествовали параметру вызова</font> 
  open() <font color="#000000">*/</font><br>
  <br>
  (void)<a href="../../man/umask2.htm">umask</a>(0); <br>
  <br>
  <font color="#000000">/* Попытаемся открыть файл с именем myfile в текущей директории 
  только<br>
  для операций вывода. Если файл не существует, попробуем его создать с правами 
  <br>
  доступа</font> 0666<font color="#000000">, т. &nbsp;е. read-write для всех категорий 
  пользователей */</font><br>
  <br>
  if((fd = <a href="../../man/open.htm">open</a>(&quot;myfile&quot;, O_WRONLY 
  | O_CREAT, 0666)) &lt; 0){<br>
  </b><dir><b>
  <br>
    <font color="#000000">/* Если файл открыть не удалось, печатаем об этом сообщение 
    и прекращаем работу */</font><br>
  <br> printf(&quot;Can\'t open file\n&quot;);<br>
    <a href="../../man/exit.htm">exit</a>(-1); <br>
  </b></dir>
  <b>} <br>
  <br>
  <font color="#000000">/* Пробуем записать в файл 14 байт из нашего массива, 
  т.е. всю строку </font>"Hello, world!" <br>
  <font color="#000000">вместе с признаком конца строки */</font><br>
  <br>
  size = <a href="../../man/read.htm">write</a>(fd, string, 14);<br>
  <br>
  if(size != 14){<br>
  </b><dir><b><br>
    <font color="#000000">/* Если записалось меньшее количество байт, сообщаем 
    об ошибке */</font><br>
  <br> printf(&quot;Can\'t write all string\n&quot;); <br>
    <a href="../../man/exit.htm">exit</a>(-1); <br>
  </b></dir>
  <b>} <br> 
  <br>
  <br>
  <font color="#000000">/* Закрываем файл */</font><br>
  <br>
  if(<a href="../../man/close.htm">close</a>(fd) &lt; 0){ <br>
  </b><dir><b> printf(&quot;Can\'t close file\n&quot;);<br>
  </b></dir>
  <b>}<br>
  <br>
  return 0; </b></dir>
<b>} </b></font> 
</body>

</html>
